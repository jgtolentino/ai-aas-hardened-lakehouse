apiVersion: apps/v1
kind: Deployment
metadata: { name: worker }
spec:
  strategy: { type: RollingUpdate, rollingUpdate: { maxUnavailable: 0, maxSurge: 1 } }
  template:
    spec:
      securityContext: { runAsNonRoot: true, seccompProfile: { type: RuntimeDefault } }
      containers:
      - name: worker
        securityContext:
          allowPrivilegeEscalation: false
          capabilities: { drop: ["ALL"] }
          readOnlyRootFilesystem: true
        resources:
          requests: { cpu: "100m", memory: "128Mi" }
          limits:   { cpu: "1000m", memory: "1Gi" }
        livenessProbe:  { exec: { command: ["node","-e","process.exit(0)"] }, periodSeconds: 20 }
        readinessProbe: { exec: { command: ["node","-e","process.exit(0)"] }, periodSeconds: 10 }