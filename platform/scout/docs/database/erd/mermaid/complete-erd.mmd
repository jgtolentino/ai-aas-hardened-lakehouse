erDiagram
    schema_registry {
        uuid id
        text schema_name
        text purpose
        text access_level
        text data_classification
        integer retention_period_days
        timestamptz created_at
        timestamptz updated_at
    }
    table_metadata {
        uuid id
        text schema_name
        text table_name
        text business_purpose
        text data_source
        text update_frequency
        text data_owner
        text steward_email
        decimal quality_score
        timestamptz last_quality_check
        bigint record_count
        timestamptz created_at
        timestamptz updated_at
    }
    data_lineage {
        uuid id
        text source_schema
        text source_table
        text target_schema
        text target_table
        text transformation_type
        text transformation_logic
        integer dependency_level
        timestamptz created_at
    }
    audit_log {
        uuid id
        text schema_name
        text table_name
        uuid record_id
        text operation_type
        jsonb old_values
        jsonb new_values
        uuid changed_by
        timestamptz changed_at
        text change_reason
        inet ip_address
        text user_agent
    }
    raw_transactions {
        uuid id
        text source_system
        text external_transaction_id
        jsonb raw_payload
        timestamptz ingestion_timestamp
        text file_name
        uuid batch_id
        text validation_status
        jsonb validation_errors
        timestamptz processed_at
    }
    raw_products {
        uuid id
        text source_system
        text external_product_id
        jsonb raw_payload
        timestamptz ingestion_timestamp
        uuid batch_id
        text validation_status
        jsonb validation_errors
    }
    raw_customers {
        uuid id
        text source_system
        text external_customer_id
        jsonb raw_payload
        timestamptz ingestion_timestamp
        uuid batch_id
        text validation_status
        jsonb validation_errors
        boolean pii_masked
    }
    transactions {
        uuid id
        uuid bronze_source_id
        text transaction_id
        uuid store_id
        uuid customer_id
        timestamptz transaction_date
        decimal subtotal
        decimal tax_amount
        decimal discount_amount
        decimal total_amount
        text payment_method
        text currency
        text receipt_number
        text pos_terminal_id
        text cashier_id
        text transaction_status
        text notes
        timestamptz created_at
        timestamptz updated_at
    }
    transaction_items {
        uuid id
        uuid transaction_id
        uuid product_id
        text product_sku
        text product_name
        text category
        text brand
        decimal quantity
        decimal unit_price
        decimal line_discount
        decimal line_total
        decimal cost_of_goods
        text promotion_code
        timestamptz created_at
    }
    stores {
        uuid id
        text store_code
        text store_name
        text store_type
        text region
        text province
        text city
        text barangay
        text address
        text postal_code
        text psgc_code
        decimal latitude
        decimal longitude
        text mall_name
        text floor_level
        decimal store_size_sqm
        date opening_date
        text manager_name
        text contact_phone
        text status
        timestamptz created_at
        timestamptz updated_at
    }
    products {
        uuid id
        text product_sku
        text product_name
        text description
        text category
        text subcategory
        text brand
        text unit_of_measure
        decimal unit_cost
        decimal suggested_retail_price
        decimal wholesale_price
        decimal weight_grams
        text dimensions_cm
        text barcode
        text supplier_name
        text country_of_origin
        boolean is_active
        date launch_date
        date discontinue_date
        timestamptz created_at
        timestamptz updated_at
    }
    customers {
        uuid id
        text customer_code
        text email
        text phone_number
        date date_of_birth
        text gender
        text region
        text province
        text city
        date signup_date
        text preferred_language
        text loyalty_tier
        decimal total_lifetime_value
        integer total_transactions
        timestamptz last_transaction_date
        text customer_status
        text acquisition_channel
        timestamptz created_at
        timestamptz updated_at
    }
    kpi_daily_summary {
        uuid id
        date date
        uuid store_id
        decimal total_revenue
        integer total_transactions
        integer unique_customers
        decimal average_transaction_value
        integer items_sold
        decimal gross_margin
        text top_category
        text top_product_sku
        text weather_condition
        boolean is_holiday
        timestamptz created_at
    }
    product_performance {
        uuid id
        text product_sku
        text product_name
        text category
        text brand
        text time_period
        date period_start
        date period_end
        integer units_sold
        decimal gross_revenue
        decimal gross_margin
        decimal margin_percentage
        decimal inventory_turns
        integer stockout_days
        integer velocity_rank
        text abc_classification
        timestamptz created_at
    }
    customer_segments {
        uuid id
        uuid customer_id
        text segment_name
        decimal segment_score
        decimal lifetime_value
        integer recency_days
        integer frequency_score
        integer monetary_score
        text rfm_segment
        date predicted_next_purchase_date
        decimal churn_probability
        jsonb recommended_actions
        date segment_date
        timestamptz created_at
    }
    store_performance {
        uuid id
        uuid store_id
        text time_period
        date period_start
        date period_end
        decimal total_revenue
        decimal revenue_growth_percentage
        integer total_transactions
        decimal transaction_growth_percentage
        decimal average_basket_size
        decimal conversion_rate
        decimal customer_satisfaction_score
        decimal staff_productivity_score
        integer region_rank
        text performance_tier
        timestamptz created_at
    }
    market_basket_analysis {
        uuid id
        text product_a_sku
        text product_b_sku
        integer support_count
        decimal confidence
        decimal lift
        decimal conviction
        date analysis_period_start
        date analysis_period_end
        decimal minimum_support_threshold
        boolean is_significant
        timestamptz created_at
    }
    demand_forecast {
        uuid id
        text product_sku
        uuid store_id
        date forecast_date
        integer predicted_demand
        integer confidence_interval_lower
        integer confidence_interval_upper
        decimal model_accuracy
        decimal seasonality_factor
        decimal trend_factor
        jsonb external_factors
        text model_version
        timestamptz forecast_generated_at
    }
    price_optimization {
        uuid id
        text product_sku
        uuid store_id
        decimal current_price
        decimal recommended_price
        decimal price_elasticity
        integer demand_at_current_price
        integer demand_at_recommended_price
        decimal revenue_impact
        decimal margin_impact
        decimal competitor_price_avg
        decimal market_share_impact
        decimal recommendation_confidence
        date valid_from
        date valid_until
        text model_version
        timestamptz created_at
    }
    customer_lifetime_value {
        uuid id
        uuid customer_id
        decimal predicted_clv
        decimal historical_clv
        integer clv_percentile
        integer predicted_tenure_months
        decimal churn_risk_score
        decimal next_purchase_probability
        decimal recommended_marketing_spend
        text customer_stage
        jsonb key_value_drivers
        text model_version
        date prediction_date
        timestamptz created_at
    }
    anomaly_detection {
        uuid id
        text anomaly_type
        text entity_type
        uuid entity_id
        decimal anomaly_score
        decimal expected_value
        decimal actual_value
        decimal deviation_percentage
        timestamptz detection_timestamp
        boolean is_confirmed
        text root_cause
        text resolution_action
        timestamptz resolved_at
        text model_version
        jsonb additional_context
    }
    psgc_codes {
        uuid id
        text psgc_code
        text region_name
        text province_name
        text city_municipality
        text barangay_name
        text geographic_level
        text island_group
        integer population
        decimal land_area_sqkm
        boolean is_urban
        text economic_zone
        timestamptz created_at
    }
    philippine_holidays {
        uuid id
        date holiday_date
        text holiday_name
        text holiday_type
        boolean is_nationwide
        text affected_regions
        text business_impact
        timestamptz created_at
    }